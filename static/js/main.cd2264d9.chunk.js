(this["webpackJsonpreact_dynamic-list-of-posts"]=this["webpackJsonpreact_dynamic-list-of-posts"]||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports=a(22)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(9),o=a.n(r),s=a(1),m=(a(16),a(17),"https://mate-api.herokuapp.com");function l(e,t){return fetch(e,t).then((function(e){if(!e.ok)throw new Error("Error ".concat(e.status,": ").concat(e.statusText));return e.json()})).then((function(e){return e.data}))}function u(){return l("".concat(m,"/posts"))}a(18);var i=function(e){var t=e.userId,a=e.setPostId,r=e.setPostOpen,o=Object(n.useState)([]),m=Object(s.a)(o,2),l=m[0],i=m[1],d=Object(n.useState)(""),b=Object(s.a)(d,2),p=b[0],f=b[1];Object(n.useEffect)((function(){t?function(e){return u().then((function(t){return t.filter((function(t){return t.userId===e}))}))}(t).then(i):u().then(i)}),[t]);return c.a.createElement("div",{className:"PostsList"},c.a.createElement("h2",null,"Posts:"),c.a.createElement("ul",{className:"PostsList__list"},l.map((function(e){return c.a.createElement("li",{className:"PostsList__item",key:e.id},c.a.createElement("div",null,c.a.createElement("b",null,"[User",e.name,"]:"," "),e.body),p!==e.id?c.a.createElement("button",{type:"button",className:"PostsList__button button",onClick:function(){return t=e.id,f(t),a(t),void r(t);var t}},"Open"):c.a.createElement("button",{type:"button",className:"PostsList__button button button--active",onClick:function(){return f(""),void r(!1)}},"Close"))}))))},d=a(6),b=a(3),p=a(4),f=(a(19),a(10)),E=c.a.memo((function(e){var t=e.postID,a=e.addNewComment,r={name:"",email:"",body:"",postId:t},o=Object(n.useState)(r),m=Object(s.a)(o,2),l=m[0],u=m[1],i=Object(f.a)({initialValues:r}),b=i.register,E=i.handleSubmit,_=i.formState.errors,N=i.reset;Object(n.useEffect)((function(){N({errors:!1})}),[t]);var O=function(e){var t=e.target,a=t.name,n=t.value;u((function(e){return Object(d.a)(Object(d.a)({},e),{},Object(p.a)({},a,n))}))};return c.a.createElement("form",{className:"NewCommentForm",onSubmit:E((function(){a(l),u(r)})),method:"POST"},c.a.createElement("div",{className:"form-field"},c.a.createElement("input",Object.assign({type:"text",name:"name",placeholder:"Your name",className:"NewCommentForm__input",value:l.name},b("name",{required:!0}),{onChange:O})),_.name&&c.a.createElement("p",{className:"NewCommentForm__error"},"Name is required.")),c.a.createElement("div",{className:"form-field"},c.a.createElement("input",Object.assign({type:"text",name:"email",placeholder:"Your email",className:"NewCommentForm__input",value:l.email},b("email",{required:!0},{pattern:/\S+@\S+/}),{onChange:O})),_.email&&c.a.createElement("p",{className:"NewCommentForm__error"},"Email is required and must be valid.")),c.a.createElement("div",{className:"form-field"},c.a.createElement("textarea",Object.assign({name:"body",placeholder:"Type comments here",className:"NewCommentForm__input",value:l.body},b("body",{required:!0}),{onChange:O})),_.body&&c.a.createElement("p",{className:"NewCommentForm__error"},"Comment body text is required.")),c.a.createElement("button",{type:"submit",className:"NewCommentForm__submit-button button"},"Add a comment"))}));a(21);var _=function(e){var t=e.postId,a=Object(n.useState)([]),r=Object(s.a)(a,2),o=r[0],u=r[1],i=Object(n.useState)(null),p=Object(s.a)(i,2),f=p[0],_=p[1],N=Object(n.useState)(!1),O=Object(s.a)(N,2),h=O[0],j=O[1];Object(n.useEffect)((function(){(function(e){return l("".concat(m,"/posts/").concat(e))})(t).then(u),function(e){return l("".concat(m,"/comments?postId=").concat(e))}(t).then(_)}),[t]);var v=function(e){!function(e){l("".concat(m,"/comments/").concat(e),{method:"DELETE"})}(e),_((function(t){return t.filter((function(t){return t.id!==e}))}))},y=Object(n.useCallback)((function(e){var t=Math.max.apply(Math,Object(b.a)(f.map((function(e){return Number(e.id)}))))+1,a=Object(d.a)(Object(d.a)({},e),{},{id:t});!function(e){l("".concat(m,"/comments"),{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(e)})}(a),_((function(e){return[].concat(Object(b.a)(e),[a])}))}),[f]);return c.a.createElement("div",{className:"PostDetails"},c.a.createElement("h2",null,o.title),c.a.createElement("section",{className:"PostDetails__post"},c.a.createElement("p",null,o.body)),f&&c.a.createElement("section",{className:"PostDetails__comments"},c.a.createElement("button",{type:"button",className:"button",onClick:function(){j(!h)}},h?"Show":"Hide"," ",f.length," ","comments"),!h&&c.a.createElement("ul",{className:"PostDetails__list"},f.map((function(e){return c.a.createElement("li",{className:"PostDetails__list-item",key:e.id},c.a.createElement("button",{type:"button",className:"PostDetails__remove-button button",onClick:function(){return v(e.id)}},"\u2716"),c.a.createElement("p",null,e.body))})))),c.a.createElement("section",null,c.a.createElement("div",{className:"PostDetails__form-wrapper"},c.a.createElement(E,{postID:t,addNewComment:y}))))};var N=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(""),u=Object(s.a)(o,2),d=u[0],b=u[1],p=Object(n.useState)(""),f=Object(s.a)(p,2),E=f[0],N=f[1],O=Object(n.useState)(!1),h=Object(s.a)(O,2),j=h[0],v=h[1];Object(n.useEffect)((function(){l("".concat(m,"/users")).then((function(e){return e.filter((function(e,t,a){return 0===t||e.name!==a[t-1].name}))})).then((function(e){return r(e)}))}),[]);return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App__header"},a?c.a.createElement("label",null,"Select a user: \xa0",c.a.createElement("select",{name:"user",className:"App__user-selector",value:d,onChange:function(e){var t=e.target.value;b(t)}},c.a.createElement("option",{value:""},"Choose a user"),a.map((function(e){return c.a.createElement("option",{value:e.id,key:e.id},e.name)})))):c.a.createElement("div",{className:"App__loading-message"},"Loading data...")),c.a.createElement("main",{className:"App__main"},c.a.createElement("div",{className:"App__sidebar"},c.a.createElement(i,{userId:+d,setPostId:N,setPostOpen:v})),c.a.createElement("div",{className:"App__content"},j&&c.a.createElement(_,{postId:Number(E)}))))};o.a.render(c.a.createElement(N,null),document.getElementById("root"))}],[[11,1,2]]]);
//# sourceMappingURL=main.cd2264d9.chunk.js.map