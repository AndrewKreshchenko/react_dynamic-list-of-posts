(this["webpackJsonpreact_dynamic-list-of-posts"]=this["webpackJsonpreact_dynamic-list-of-posts"]||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports=a(22)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(9),o=a.n(s),r=a(1),m=(a(16),a(17),"https://mate-api.herokuapp.com");function l(e,t){return fetch(e,t).then((function(e){if(!e.ok)throw new Error("Error ".concat(e.status,": ").concat(e.statusText));return e.json()})).then((function(e){return e.data}))}function u(){return l("".concat(m,"/posts"))}a(18);var i=function(e){var t=e.userId,a=e.postId,s=e.setPostId,o=Object(n.useState)([]),m=Object(r.a)(o,2),l=m[0],i=m[1];Object(n.useEffect)((function(){t?function(e){return u().then((function(t){return t.filter((function(t){return t.userId===e}))}))}(t).then(i):u().then(i)}),[t]);var d=function(){s("")};return c.a.createElement("div",{className:"PostsList"},c.a.createElement("h2",null,"Posts:"),c.a.createElement("ul",{className:"PostsList__list"},l.map((function(e){return c.a.createElement("li",{className:"PostsList__item",key:e.id},c.a.createElement("div",null,c.a.createElement("b",null,"[User",e.name,"]:"," "),e.body),a!==e.id?c.a.createElement("button",{type:"button",className:"PostsList__button button",onClick:function(){return t=e.id,void s(t);var t}},"Open"):c.a.createElement("button",{type:"button",className:"PostsList__button button button--active",onClick:d},"Close"))}))))},d=a(3),b=a(6),f=a(4),p=(a(19),a(10)),E=c.a.memo((function(e){var t=e.postID,a=e.addNewComment,s={name:"",email:"",body:"",postId:t},o=Object(n.useState)(s),m=Object(r.a)(o,2),l=m[0],u=m[1],i=Object(p.a)({initialValues:s}),d=i.register,E=i.handleSubmit,_=i.formState.errors,N=i.reset;Object(n.useEffect)((function(){N({errors:!1}),u(s)}),[t]);var h=function(e){var t=e.target,a=t.name,n=t.value;u((function(e){return Object(b.a)(Object(b.a)({},e),{},Object(f.a)({},a,n))}))};return c.a.createElement("form",{className:"NewCommentForm",onSubmit:E((function(){a(l),u(s)})),method:"POST"},c.a.createElement("div",{className:"form-field"},c.a.createElement("input",Object.assign({type:"text",name:"name",placeholder:"Your name",className:"NewCommentForm__input",value:l.name},d("name",{required:"Name is required."}),{onChange:h})),_.name&&c.a.createElement("p",{className:"NewCommentForm__error"},_.name.message)),c.a.createElement("div",{className:"form-field"},c.a.createElement("input",Object.assign({type:"text",name:"email",placeholder:"Your email",className:"NewCommentForm__input",value:l.email},d("email",{required:"Email is required.",pattern:{value:/\S+@\S+\.\S+/,message:"Entered email does not match email format."}}),{onChange:h})),_.email&&c.a.createElement("p",{className:"NewCommentForm__error"},_.email.message)),c.a.createElement("div",{className:"form-field"},c.a.createElement("textarea",Object.assign({name:"body",placeholder:"Type comments here",className:"NewCommentForm__input",value:l.body},d("body",{required:"Message text is required.",minLength:{value:5,message:"Minimal length of message text is 5."},pattern:{value:/^$|.*\S+.*/,message:"Message should't be made up of whitespaces."}}),{onChange:h})),_.body&&c.a.createElement("p",{className:"NewCommentForm__error"},_.body.message)),c.a.createElement("button",{type:"submit",className:"NewCommentForm__submit-button button"},"Add a comment"))}));a(21);var _=function(e){var t=e.postId,a=Object(n.useState)([]),s=Object(r.a)(a,2),o=s[0],u=s[1],i=Object(n.useState)(null),f=Object(r.a)(i,2),p=f[0],_=f[1],N=Object(n.useState)(!1),h=Object(r.a)(N,2),v=h[0],O=h[1];Object(n.useEffect)((function(){(function(e){return l("".concat(m,"/posts/").concat(e))})(t).then(u),function(e){return l("".concat(m,"/comments?postId=").concat(e))}(t).then(_)}),[t]);var j=function(e){!function(e){l("".concat(m,"/comments/").concat(e),{method:"DELETE"})}(e),_((function(t){return t.filter((function(t){return t.id!==e}))}))},g=Object(n.useCallback)((function(e){var t=Date.now().toString(),a=Object(b.a)(Object(b.a)({},e),{},{id:Number(t.substr(t.length-5))});!function(e){l("".concat(m,"/comments"),{method:"POST",headers:{"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify(e)})}(a),_((function(e){return[].concat(Object(d.a)(e),[a])}))}),[p]);return c.a.createElement("div",{className:"PostDetails"},c.a.createElement("h2",null,o.title),c.a.createElement("section",{className:"PostDetails__post"},c.a.createElement("p",null,o.body)),p&&c.a.createElement("section",{className:"PostDetails__comments"},c.a.createElement("button",{type:"button",className:"button",onClick:function(){O(!v)}},v?"Show":"Hide"," ",p.length," ","comments"),!v&&c.a.createElement("ul",{className:"PostDetails__list"},p.map((function(e){return c.a.createElement("li",{className:"PostDetails__list-item",key:e.id},c.a.createElement("button",{type:"button",className:"PostDetails__remove-button button",onClick:function(){return j(e.id)}},"\u2716"),c.a.createElement("p",null,e.body))})))),c.a.createElement("section",null,c.a.createElement("div",{className:"PostDetails__form-wrapper"},c.a.createElement(E,{postID:t,addNewComment:g}))))};var N=function(){var e=Object(n.useState)(null),t=Object(r.a)(e,2),a=t[0],s=t[1],o=Object(n.useState)(""),u=Object(r.a)(o,2),d=u[0],b=u[1],f=Object(n.useState)(""),p=Object(r.a)(f,2),E=p[0],N=p[1];Object(n.useEffect)((function(){l("".concat(m,"/users")).then((function(e){return e.filter((function(e,t,a){return 0===t||e.name!==a[t-1].name}))})).then((function(e){return s(e)}))}),[]);return c.a.createElement("div",{className:"App"},c.a.createElement("header",{className:"App__header"},a?c.a.createElement("label",null,"Select a user: \xa0",c.a.createElement("select",{name:"user",className:"App__user-selector",value:d,onChange:function(e){var t=e.target.value;b(t)}},c.a.createElement("option",{value:""},"Choose a user"),a.map((function(e){return c.a.createElement("option",{value:e.id,key:e.id},e.name)})))):c.a.createElement("div",{className:"App__loading-message"},"Loading data...")),c.a.createElement("main",{className:"App__main"},c.a.createElement("div",{className:"App__sidebar"},c.a.createElement(i,{userId:+d,postId:Number(E),setPostId:N})),c.a.createElement("div",{className:"App__content"},"number"===typeof E&&c.a.createElement(_,{postId:Number(E)}))))};o.a.render(c.a.createElement(N,null),document.getElementById("root"))}],[[11,1,2]]]);
//# sourceMappingURL=main.03987597.chunk.js.map